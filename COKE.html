<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="COKE: A Cognitive Knowledge Graph for Machine Theory of Mind">
  <meta name="keywords" content="Theory of Mind, Cognitive Reasoning, LLM, Knowledge Graph">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>COKE: A Cognitive Knowledge Graph for Machine Theory of Mind</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./COKE/css/bulma.min.css">
  <link rel="stylesheet" href="./COKE/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./COKE/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./COKE/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./COKE/css/index.css">
  <link rel="icon" href="./COKE/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./COKE/js/fontawesome.all.min.js"></script>
  <script src="./COKE/js/bulma-carousel.min.js"></script>
  <script src="./COKE/js/bulma-slider.min.js"></script>
  <script src="./COKE/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://jincenziwu.github.io/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">COKE: A Cognitive Knowledge Graph for Machine Theory of Mind</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://jincenziwu.github.io/">Jincenzi Wu</a><sup>1,2*</sup>,</span>
            <span class="author-block">
              <a href="https://zhuangchen.tech/">Zhuang Chen</a><sup>1*</sup>,</span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=fseN_08AAAAJ&hl=en&oi=ao">Jiawen Deng</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=EaOudNsAAAAJ&hl=en">Sahand Sabour</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.se.cuhk.edu.hk/people/academic-staff/prof-meng-mei-ling-helen/"> Helen Meng</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://coai.cs.tsinghua.edu.cn/hml">Minlie Huang</a><sup>1‡</sup>,
            </span>

          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Tsinghua University</span>
            <span class="author-block"><sup>2</sup>The Chinese University of Hong Kong</span>
            <span class="author-block"><sup>3</sup>University of Electronic Science and Technology of China</span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">*Equal Contribution</span>
            <span class="author-block">‡Corresponding author</span>

          </div>

          <div class="is-size-5 publication-email">
            <a class="p-2 text-decoration-none" href="mailto:jincenziwu@gmail.com">jincenziwu@gmail.com</a>
            <a class="p-2 text-decoration-none" href="mailto:zhchen-nlp@mail.tsinghua.edu.cn">zhchen-nlp@mail.tsinghua.edu.cn</a>
          </div>


          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2305.05390"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2305.05390"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>

              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/jincenziwu/COKE"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://github.com/jincenziwu/COKE"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
            </div>


          </div>
        </div>
      </div>
    </div>
  </div>
</section>





<section class="section">
  <div class="container is-max-desktop">


    <div class="tile is-ancestor">
                <div class="tile is-6 is-vertical is-parent">
                   <img src="COKE/images/COKE_Overview.png">
                </div>

                <div class="tile is-7 is-parent">
                  <div class="tile is-child">
                    <p>
                    Theory of mind (ToM) refers to humans' ability to understand and infer the desires, beliefs, and intentions of others.
                    The acquisition of ToM plays a key role in humans' social cognition and interpersonal relations.
                    ToM is still lacking for modern AI and NLP systems since they cannot access the human mental state and cognitive process beneath the training corpus.
                  </p>
                  <p>
                    To empower AI systems with the ToM ability and narrow the gap between them and humans,
                    <br>
                    <b>(1)</b> we propose <b>COKE</b>: the first cognitive knowledge graph for machine theory of mind. Specifically, COKE formalizes ToM as a collection of <b> 45k+ manually verified cognitive chains </b> that characterize human mental activities and subsequent behavioral responses and affective responses when facing specific social circumstances.

                    <b>(2)</b> we build a powerful cognitive language model <b>COLM</b> by associating COKE  with LLaMA-2, so as to predict cognitive chains for out-of-KG situations.

                    <b>(3)</b> we conduct extensive experiments to evaluate the ToM ability of COLM and typical LLMs. The results show that  <b>COLM outperforms strong baseline models such as GPT-4 in both zero-shot and few-shot settings </b>, proved by automatic and human evaluations in all cognitive generation tasks, which in turn demonstrates the high quality of COKE.

                    <b>(4)</b> we further substantiate the potential of COKE in enhancing  <b>social applications </b> and prove its effectiveness on downstream  <b>emotional support conversation tasks </b>.

                  </p>
                  </div>
                </div>
    </div>


  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">

    <!-- Data Structure. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
          <!-- Data Structure. -->
        <h2 class="title is-3">Data Structure of COKE</h2>
        <div class="content has-text-justified">
          <p>
            We specify five types of nodes in COKE:
            <b>situations, clues, thoughts, actions, and emotions</b>.
            We here define the basic unit of COKE as the following cognitive chain:
            <b>Situation⇒Clue⇒Thought⇒(Action+Emotion)</b>.
            Furthermore, to distinguish whether a cognitive chain is optimistic or pessimistic under the specific situation, we further define its polarity as <b>positive</b> or <b>negative</b>.

          </p>
        </div>

        <div class="columns is-vcentered interpolation-panel">
           <img src="COKE/images/COKE_Dimension.png" alt="dap">
        </div>


        <br/>
        <!--/ Interpolating. -->



      </div>
    </div>
    <!--/ Data Structure. -->

     <!-- Data Collection. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
          <!-- Data Structure. -->
        <h2 class="title is-3">Data Collection</h2>
        <div class="content has-text-justified">
          <p>
            As shown in Figure below,
            <b>1)</b> we first manually design suitable few-shot prompts to induce GPT-3.5 to automatically generate raw data for five types of nodes in a pipeline manner.
            <b>2)</b> We then recruit and train eight graduate students majoring in social psychology as annotators to select and revise the outputs of GPT-3.5.
          </p>
        </div>

        <div class="columns is-vcentered interpolation-panel">
           <img src="COKE/images/COKE_Collection.png" alt="dap">
        </div>


        <br/>
        <!--/ Interpolating. -->



      </div>
    </div>
    <!--/ Data Collection. -->

    <!-- Experiment. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
          <!-- Data Structure. -->
        <h2 class="title is-3">Experiment</h2>
        <div class="content has-text-justified">
          <p>
        Given a situation, we can decompose the cognitive process into the following four generation tasks as shown in the Table.
        </p>
        </div>

        <div class="columns is-vcentered interpolation-panel">
           <img src="COKE/images/COKE_Tasks.png" alt="dap">
        </div>
        <div class="content has-text-justified">
          <p>
            Compared to <b>baseline models </b>like LLaMA-2 and Mistral, which face challenges in following task instructions,
            COLM shows significant performance enhancements across various cognitive generation tasks with COKE.

            While leveraging additional prompts boosts performance for <b>powerful models </b>like GPT-3.5 Turbo and GPT-4 via in-context learning in clue/thought/action generation tasks, these LLMs still struggle with complex emotional understanding and fail in
the emotion classification task. Compared to these powerful LLMs, COLM maintains substantial advantages across all evaluation metrics.
            <br>
            We hereby have two observations:
            1) The data we collected in COKE is of high quality and can empower the model with strong ToM ability.
            2) COLM, which is designed as a controllable generative model for multiple cognitive tasks, can effectively internalize the ToM ability and cope with unseen situations

          </p>
        </div>

        <div class="columns is-vcentered interpolation-panel">
           <img src="COKE/images/COKE_Experiment.png" alt="dap">
        </div>


        <br/>
        <!--/ Interpolating. -->



      </div>
    </div>
    <!--/Experiment. -->


    <!-- Downstream task. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
          <!-- Data Structure. -->
        <h2 class="title is-3">Downstream Task</h2>

        <h7 class="title is-4">Emotional Support Conversation</h7>
        <div class="content has-text-justified">
          <p>
            As COKE is a cognitive knowledge graph for machine theory of mind, we further substantiate its effectiveness in empowering social applications
            with ToM capabilities. Our chosen testing ground is the <b> emotional support conversation (ESC) </b> task. The prime objective of ESC is to generate empathetic and effective responses in social dialogues, with the aim of mitigating users’ emotional distress and fostering improved mental
states.
            <br>
            We treat each user’s utterance in the dialogue as a clue, and employ COLM to infer two thoughts (1 positive and 1 negative) via thought generation. Based on the generated thoughts, we can accordingly infer actions for each thought via action generation.
            We simply extract verbs and nouns in thoughts or actions as the ToM knowledge keywords, and append them to the end of dialogue history, serving as an enhanced context. Based on the context, the ESC system is trained to generate the corresponding response.
          </p>
        </div>

        <div class="columns is-vcentered interpolation-panel">
           <img src="COKE/images/COKE_ESC.png" alt="dap">
        </div>

        <h7 class="title is-4"> Case Study </h7>
        <div class="content has-text-justified">
          <p>
            Here is a case study and how COKE offers a more nuanced and empathetic approach to AI-driven emotional support.
          </p>
        </div>


        <div class="columns is-vcentered interpolation-panel">
        <img src="COKE/images/COKE_ESC_Case.png">
        </div>

        <br/>
        <!--/ Interpolating. -->



      </div>
    </div>
    <!--/Downstream task. -->

<!--    <div class="container is-max-desktop">-->


<!--    <div class="tile is-ancestor">-->
<!--      <div class="tile is-6 is-vertical is-parent">-->
<!--        <img src="COKE/images/COKE_ESC_M.png">-->
<!--      </div>-->
<!--      <div class="tile is-6 is-vertical is-parent">-->
<!--        <img src="COKE/images/COKE_ESC_Case.png">-->
<!--      </div>-->

<!--    </div>-->


<!--  </div>-->



  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{wu2023coke,
  title={Coke: A cognitive knowledge graph for machine theory of mind},
  author={Wu, Jincenzi and Chen, Zhuang and Deng, Jiawen and Sabour, Sahand and Huang, Minlie},
  journal={arXiv preprint arXiv:2305.05390},
  year={2023}
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./COKE/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
